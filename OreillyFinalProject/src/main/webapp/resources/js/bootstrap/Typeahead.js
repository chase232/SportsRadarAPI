//>>built
define("bootstrap/Typeahead",["dojo/_base/declare","dojo/query","dojo/_base/lang","dojo/_base/window","dojo/on","dojo/dom-class","dojo/dom-attr","dojo/dom-construct","dojo/dom-geometry","dojo/dom-style","dojo/_base/array","./Support","dojo/NodeList-dom","dojo/NodeList-traverse","dojo/domReady!"],function(_1,_2,_3,_4,on,_5,_6,_7,_8,_9,_a,_b){"use strict";var _c="[data-provide=\"typeahead\"]";var _d=_1([],{defaultOptions:{source:[],items:8,menu:"<ul class=\"typeahead dropdown-menu\"></ul>",item:"<li><a href=\"#\"></a></li>",minLength:1,autocomplete:false},constructor:function(_e,_f){this.options=_3.mixin(_3.clone(this.defaultOptions),(_f||{}));this.domNode=_e;if(this.options.autocomplete===false){_6.set(_e,"autocomplete","off");}this.matcher=this.options.matcher||this.matcher;this.sorter=this.options.sorter||this.sorter;this.highlighter=this.options.highlighter||this.highlighter;this.updater=this.options.updater||this.updater;this.menuNode=_7.toDom(this.options.menu);this.source=this.options.source;this.shown=false;this.listen();},select:function(){var li=_2(".active",this.menuNode)[0];this.domNode.value=this.updater(_6.get(li,"data-value"));on.emit(this.domNode,"change",{bubbles:true,cancelable:true});return this.hide();},updater:function(_10){return _10;},show:function(){var pos=_8.position(this.domNode,true);_7.place(this.menuNode,document.body);_9.set(this.menuNode,{top:(pos.y+this.domNode.offsetHeight)+"px",left:pos.x+"px",display:"block"});this.shown=true;return this;},hide:function(){_9.set(this.menuNode,"display","none");this.shown=false;return this;},lookup:function(){var _11;this.query=this.domNode.value;if(!this.query||this.query.length<this.options.minLength){return this.shown?this.hide():this;}_11=(typeof this.source==="function")?this.source(this.query,_3.hitch(this,"process")):this.source;return _11?this.process(_11):this;},process:function(_12){_12=_a.filter(_12,function(_13){return this.matcher(_13);},this);_12=this.sorter(_12);if(!_12.length){return this.shown?this.hide():this;}this.render(_12.slice(0,this.options.items)).show();},matcher:function(_14){return (_14.toString().toLowerCase().indexOf(this.query.toLowerCase()))+1;},sorter:function(_15){var _16=[],_17=[],_18=[],_19;while(_19=_15.shift()){if(!_19.toString().toLowerCase().indexOf(this.query.toString().toLowerCase())){_16.push(_19);}else{if(_19.toString().indexOf(this.query)>=0){_17.push(_19);}else{_18.push(_19);}}}return _16.concat(_17,_18);},highlighter:function(_1a){var _1b=this.query.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&");return _1a.toString().replace(new RegExp("("+_1b+")","ig"),function($1,_1c){return "<strong>"+_1c+"</strong>";});},render:function(_1d){_1d=_a.map(_1d,function(_1e,i){var li=_7.toDom(this.options.item);_6.set(li,"data-value",_1e);_2("a",li)[0].innerHTML=this.highlighter(_1e);if(i===0){_5.add(li,"active");}return li.outerHTML;},this);this.menuNode.innerHTML=_1d.join("");return this;},next:function(){var _1f=_2(".active",this.menuNode);_1f.removeClass("active");var _20=_1f.next();if(!_20.length){_20=_2("li",this.menuNode).first();}_20.addClass("active");},prev:function(){var _21=_2(".active",this.menuNode);_21.removeClass("active");var _22=_21.prev();if(!_22.length){_22=_2("li",this.menuNode).last();}_22.addClass("active");},listen:function(){on(this.domNode,"blur",_3.hitch(this,"blur"));on(this.domNode,"keypress",_3.hitch(this,this.keypress));on(this.domNode,"keyup",_3.hitch(this,this.keyup));if(_b.eventSupported(this.domNode,"keydown")){on(this.domNode,"keydown",_3.hitch(this,"keydown"));}on(this.menuNode,"click",_3.hitch(this,"click"));on(this.menuNode,on.selector("li","mouseover"),_3.hitch(this,"mouseenter"));},move:function(e){if(!this.shown){return;}var _23=e.charCode||e.keyCode;switch(_23){case 9:case 13:case 27:e.preventDefault();break;case 38:e.preventDefault();this.prev();break;case 40:e.preventDefault();this.next();break;}e.stopPropagation();},keyup:function(e){var _24=e.charCode||e.keyCode;switch(_24){case 40:case 38:case 16:case 17:case 18:break;case 9:case 13:if(!this.shown){return;}this.select();break;case 27:if(!this.shown){return;}this.hide();break;default:this.lookup();}e.stopPropagation();e.preventDefault();},keydown:function(e){var _25=e.charCode||e.keyCode;this.suppressKeyPressRepeat=_a.indexOf([40,38,9,13,27],_25)>=0;this.move(e);},keypress:function(e){if(this.suppressKeyPressRepeat){return;}this.move(e);},blur:function(){var _26=this;setTimeout(function(){_26.hide();},150);},click:function(e){e.stopPropagation();e.preventDefault();this.select();},mouseenter:function(e){var li=_2(e.target).closest("li");_2(".active",this.menuNode).removeClass("active");li.addClass("active");}});_3.extend(_2.NodeList,{typeahead:function(_27){var _28=(_3.isObject(_27))?_27:{};return this.forEach(function(_29){var _2a=_b.getData(_29,"typeahead");if(!_2a){_b.setData(_29,"typeahead",(_2a=new _d(_29,_28)));}if(_3.isString(_27)){_2a[_27].call(_2a);}});}});on(document,on.selector(_c,"focusin"),function(e){var _2b=_b.getData(this,"typeahead");if(_2b){return;}e.preventDefault();_2(this).typeahead(_b.getData(this));});return _d;});