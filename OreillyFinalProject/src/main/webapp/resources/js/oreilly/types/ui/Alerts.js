//>>built
define("oreilly/types/ui/Alerts",["dojo/_base/declare","dijit/_WidgetBase","dojox/dtl/_Templated","dojo/_base/lang","dojo/_base/fx","dojo/dom-class","dojo/dom-style","dojo/dom-construct","dojo/_base/array","dojo/query","dojo/dom-attr","dojo/window"],function(_1,_2,_3,_4,fx,_5,_6,_7,_8,_9,_a,_b){function _c(_d,_e){if(_d.indexOf(_e)>-1){return _d;}return _4.trim(_d+" "+_e);};function _f(_10,_11){if(_10.indexOf(_11)>-1){return _4.trim(_10.replace(_11,""));}return _10;};return _1("oreilly/types/ui/Alerts",[_2,_3],{templateString:" "+"<div class=\"oap-alertsParent\" id=\"{{id}}\">"+"<div data-dojo-attach-point=\"successNode\" class=\"alert alert-success {% ifequal success.size 0 %} hidden {% endifequal %}\">"+"{% ifequal success.size 1 %}"+"{% for successmsg in success.messages %}"+"<span data-alerts-id=\"{{successmsg.id}}\" class=\"{{successmsg.cssClass|default:\"\"}}\">{{successmsg.message|safe}}</span>"+"{% endfor %}"+"{% else %}"+"{{success.title|default:\"\"}}<br>"+"<ul>{% for successmsg in success.messages %} <li data-alerts-id=\"{{successmsg.id}}\" class=\"{{successmsg.cssClass|default:\"\"}}\">{{successmsg.message|safe}}</li> {% endfor %} </ul>"+"{% endifequal %}"+"</div>"+"<div data-dojo-attach-point=\"errorNode\" class=\"alert alert-danger {% ifequal error.size 0 %} hidden {% endifequal %}\">"+"{% ifequal error.size 1 %}"+"{% for errormsg in error.messages %}"+"<span data-alerts-id=\"{{errormsg.id}}\" class=\"{{errormsg.cssClass|default:\"\"}}\">{{errormsg.message|safe}}</span>"+"{% endfor %}"+"{% else %}"+"{{error.title|default:\"\"}}<br>"+"<ul>{% for errormsg in error.messages %} <li data-alerts-id=\"{{errormsg.id}}\" class=\"{{errormsg.cssClass|default:\"\"}}\">{{errormsg.message|safe}}</li> {% endfor %} </ul>"+"{% endifequal %}"+"</div>"+"<div data-dojo-attach-point=\"warningNode\" class=\"alert alert-warning {% ifequal warning.size 0 %} hidden {% endifequal %}\">"+"{% ifequal warning.size 1 %}"+"{% for warningmsg in warning.messages %}"+"<span data-alerts-id=\"{{warningmsg.id}}\" class=\"{{warningmsg.cssClass|default:\"\"}}\">{{warningmsg.message|safe}}</span>"+"{% endfor %}"+"{% else %}"+"{{warning.title|default:\"\"}}<br>"+"<ul>{% for warningmsg in warning.messages %} <li data-alerts-id=\"{{warningmsg.id}}\" class=\"{{warningmsg.cssClass|default:\"\"}}\">{{warningmsg.message|safe}}</li> {% endfor %} </ul>"+"{% endifequal %}"+"</div>"+"<div data-dojo-attach-point=\"infoNode\" class=\"alert alert-info {% ifequal info.size 0 %} hidden {% endifequal %}\">"+"{% ifequal info.size 1 %}"+"{% for infomsg in info.messages %}"+"<span data-alerts-id=\"{{infomsg.id}}\" class=\"{{infomsg.cssClass|default:\"\"}}\">{{infomsg.message|safe}}</span>"+"{% endfor %}"+"{% else %}"+"{{info.title|default:\"\"}}<br>"+"<ul>{% for infomsg in info.messages %} <li data-alerts-id=\"{{infomsg.id}}\" class=\"{{infomsg.cssClass|default:\"\"}}\">{{infomsg.message|safe}}</li> {% endfor %} </ul>"+"{% endifequal %}"+"</div>"+"</div>",types:{error:"error",warning:"warning",info:"info",success:"success"},defaults:{error:"Error!",warning:"Warning!",info:"Information!",success:"Success!"},classHide:"hidden",fadeTime:800,constructor:function(){var _12=this,_13;this.inherited(arguments);this.success={size:0,title:_12.defaults.success,messages:{}};this.error={size:0,title:_12.defaults.error,messages:{}};this.warning={size:0,title:_12.defaults.warning,messages:{}};this.info={size:0,title:_12.defaults.info,messages:{}};this.ids={};if(arguments[1]){_13=arguments[1];if(!_13.innerHTML){_13=document.getElementById(_13);}if(!_13){return;}_9(".alert",arguments[1]).forEach(function(_14){if(_5.contains(_14,"alert-danger")){_12.addError({id:_14.id,cssClass:_4.trim(_14.className.replace("alert","").replace("alert-danger","")),message:_14.innerHTML},false);}else{if(_5.contains(_14,"alert-info")){_12.addInfo({id:_14.id,cssClass:_4.trim(_14.className.replace("alert","").replace("alert-info","")),message:_14.innerHTML},false);}else{if(_5.contains(_14,"alert-success")){_12.addSuccess({id:_14.id,cssClass:_4.trim(_14.className.replace("alert","").replace("alert-success","")),message:_14.innerHTML},false);}else{if(_5.contains(_14,"alert-warning")){_12.addWarning({id:_14.id,cssClass:_4.trim(_14.className.replace("alert","").replace("alert-warning","")),message:_14.innerHTML},false);}}}}});}},_setTimer:function(msg){var _15=this;if(msg.timer){clearTimeout(msg.timer);}if(msg.duration>0){msg.timer=setTimeout(function(){_15._doHide(msg,msg.destroyOnHide,_15.fadeOnTimer);},msg.duration);}},_prepareAlert:function(_16){if(!_16||!_16.type){throw new Error("Add needs type");}_16.id=_16.id||(new Date().getTime()+"_"+this.id);if(_16.type===this.types.success){_16.duration=_16.duration||(40*1000);}_16.message=_16.message||this.defaults[_16.type];_16.destroyOnHide=_16.destroyOnHide!==undefined?_16.destroyOnHide:false;_16.cssClass=_16.cssClass||"";if(_16.hide||_16.cssClass.indexOf(this.classHide)>-1){_16.cssClass=_c(_16.cssClass||"",this.classHide);_16.hide=true;}else{if(!this.ids[_16.id]){this[_16.type].size+=1;}else{if(this.ids[_16.id].hide||this.ids[_16.id].cssClass.indexOf(this.classHide)>-1){this[_16.type].size+=1;}}}this._setTimer(_16);this[_16.type].messages[_16.id]=_16;this[_16.type].title=_16.title||this[_16.type].title;this.ids[_16.id]=_16;},add:function(_17,_18){this._prepareAlert(_17);if(_18){this.render();if(_17.scroll===true){_b.scrollIntoView(this.domNode);}}return this;},addSuccess:function(_19,_1a){_19=_19||{};_19.type=this.types.success;return this.add(_19,true);},addError:function(_1b,_1c){_1b=_1b||{};_1b.type=this.types.error;return this.add(_1b,true);},addWarning:function(_1d,_1e){_1d=_1d||{};_1d.type=this.types.warning;return this.add(_1d,true);},addInfo:function(_1f,_20){_1f=_1f||{};_1f.type=this.types.info;return this.add(_1f,true);},_doHide:function(msg,_21,_22){var _23=this;if(msg.timer){clearTimeout(msg.timer);msg.timer=null;}if(msg.cssClass.indexOf(this.classHide)<0&&!msg.duration){this[msg.type].size-=1;}if(msg.destroyOnHide||_21){this.ids[msg.id]=undefined;delete this[msg.type].messages[msg.id];if(msg.fade){msg.fade.destroy();}if(msg.cssClass.indexOf(this.classHide)<0){this[msg.type].size-=1;this.render();}}else{if(msg.duration>0){if(msg.fade){msg.fade.destroy();}msg.fade=fx.fadeOut({node:_9("[data-alerts-id="+msg.id+"]",_23.domNode)[0],duration:_23.fadeTime,onEnd:function(){msg.cssClass=_c(msg.cssClass||"",_23.classHide);msg.fade=undefined;_23[msg.type].messages[msg.id]=msg;_23[msg.type].size-=1;if(_23[msg.type].size<0){_23[msg.type].size=0;}_23.render();}}).play();}else{msg.cssClass=_c(msg.cssClass||"",this.classHide);this[msg.type].messages[msg.id]=msg;}}if(this[msg.type].size<0){this[msg.type].size=0;}},_doShow:function(msg,_24){if(msg.cssClass.indexOf(this.classHide)>-1){msg.cssClass=_f(msg.cssClass||"",this.classHide);this[msg.type].messages[msg.id]=msg;this[msg.type].size+=1;this._setTimer(msg);}},_search:function(id,_25,_26,_27){var msg,_28,_29=this;if(!id&&!_25){for(_28 in _29.types){if(_29.types.hasOwnProperty(_28)){for(msg in _29[_28].messages){if(_29[_28].messages.hasOwnProperty(msg)){_29[_27](_29[_28].messages[msg],_26);}}}}}else{if(id&&!_25){if(this.types[id]){for(msg in _29[id].messages){if(_29[id].messages.hasOwnProperty(msg)){_29[_27](_29[id].messages[msg],_26);}}}else{if(this.ids[id]){msg=this.ids[id];this[_27](msg,_26);}else{return this;}}}else{if(id!==undefined&&_25!==undefined){msg=this.ids[id];if(msg){this[_27](msg,_26);}}else{return this;}}}this.render();return this;},hide:function(id,_2a,_2b){this._search(id,_2a,_2b,"_doHide");},clear:function(id,_2c){return this.hide(id,_2c,true);},show:function(id,_2d,_2e,_2f){this._search(id,_2d,_2e,"_doShow");if(_2f===true){_b.scrollIntoView(this.domNode);}}});});