//>>built
define("oreilly/types/dgrid/PagingGridCheckBox",["dojo/_base/declare","dojo/_base/lang","put-selector/put","dgrid/GridFromHtml","dijit/form/CheckBox","dojo/_base/array","dijit/registry","dojo/aspect","dojo/on","dojo/Evented","dojo/has","dojo/dom-class","oreilly/types/dgrid/PagingGrid"],function(_1,_2,_3,_4,_5,_6,_7,_8,on,_9,_a,_b,_c){if(!Object.keys){Object.keys=(function(){"use strict";var _d=Object.prototype.hasOwnProperty,_e=!({toString:null}).propertyIsEnumerable("toString"),_f=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],_10=_f.length;return function(obj){if(typeof obj!=="object"&&(typeof obj!=="function"||obj===null)){throw new TypeError("Object.keys called on non-object");}var _11=[],_12,i;for(_12 in obj){if(obj.hasOwnProperty(_12)){_11.push(_12);}}if(_e){for(i=0;i<_10;i+=1){if(_d.call(obj,_f[i])){_11.push(_f[i]);}}}return _11;};}());}function _13(_14,val,_15,_16){if(_14.disabled[_16[_14.collection.idProperty]]){return false;}if(val){_14.checked[_15]=_16;}else{if(_14.checked[_15]){delete _14.checked[_15];}}if(_14.field!==undefined&&_14.field!==null){_16[_14.field]=val;}};function _17(_18,_19){var val;if(_18.disabled[_19[_18.collection.idProperty]]){return false;}if(_18.field!==undefined&&_18.field!==null){val=_19[_18.field]||"";if(val===true||"".toLocaleLowerCase.apply(val)==="y"||"".toLocaleLowerCase.apply(val)==="true"||val>0){return true;}}else{return _18.checked[_19[_18.collection.idProperty]];}};function _1a(val,_1b){var _1c=_1b.selectAll?(_1b.collection.storage.fullData||_1b.collection.objectStore.data):_1b._lastCollection,_1d=[];if(!_1c){_1b.refresh({keepCurrentPage:true});_1c=_1b.selectAll?(_1b.collection.storage.fullData||_1b.collection.objectStore.data):_1b._lastCollection;}_6.forEach(_1c,function(_1e){_13(_1b,val,_1e[_1b.collection.idProperty],_1e);if(!_1b.disabled[_1e[_1b.collection.idProperty]]){_1d.push(_1e);}});_1b.refresh({keepCurrentPage:true});_1b.emit("checkbox-all",{items:_1d,selected:val});};function _1f(_20,_21,_22){var _23=this.grid,_24,_25=false;_b.add(_22,"dgrid-checkbox-cell");_23.disabled[_20[_23.collection.idProperty]]=_23.disableFunction?_23.disableFunction(_20):false;_24=_7.byId("oap-checkbox-"+_20[_23.collection.idProperty]+_23.id);if(_23.disabled[_20[_23.collection.idProperty]]===false){_25=_17(_23,_20);}if(!_24){_24=new _5({rowId:_20[_23.collection.idProperty],checked:_25,id:"oap-checkbox-"+_20[_23.collection.idProperty]+_23.id,disabled:_23.disabled[_20[_23.collection.idProperty]],onChange:function(val){if(val){_23.checked[this.rowId]=_20;}else{if(_23.checked[this.rowId]){delete _23.checked[this.rowId];}}if(_23.field!==undefined&&_23.field!==null){_20[_23.field]=val;}_23.checkHeader();if(_24._focused&&!(val instanceof Object)){_23.emit("checkbox",{item:_20,selected:val});}}},_22.appendChild(document.createElement("div")));}else{_24.set("checked",_25);_24.set("disabled",_23.disabled[_20[_23.collection.idProperty]]);}return _24.domNode;};function _26(_27){var _28=this.grid,_29=new _5({id:"oap-checkboxheader-"+_28.id,onClick:function(){_1a(this.get("checked"),_28);}},_27.appendChild(document.createElement("div")));_b.add(_27,"dgrid-checkbox-header");if(_28.subRows&&_28.subRows.headerRows&&_28.subRows.headerRows[0][0].headerNode){_b.add(_28.subRows.headerRows[0][0].headerNode,"dgrid-checkbox-header");}return _29.domNode;};function _2a(_2b,_2c,_2d){var _2e=[],trs=_2b.getElementsByTagName("tr"),_2f=trs.length,_30=_4.utils.getColumnFromCell,_31,tr,ths,_32,i,j,_33={label:"",sortable:false},_34={label:"",sortable:false};for(i=0;i<_2f;i+=1){_31=[];_2e.push(_31);tr=trs[i];ths=tr.getElementsByTagName("th");_32=ths.length;if(_2d.headerLevel===1){_31.push({name:"checkbox",sortable:false,renderCell:_1f,renderHeaderCell:_26,"class":"dgrid-checkbox-header",label:""});}else{if(_2d.headerLevel>2){_34.children=[_33];for(j=2;j<_2d.headerLevel-1;j+=1){_33.children=[{label:"",sortable:false}];_33=_33.children[0];}_33.children=[{name:"checkbox",sortable:false,renderCell:_1f,renderHeaderCell:_26,"class":"dgrid-checkbox-header",label:""}];}else{_34.children=[{name:"checkbox",sortable:false,renderCell:_1f,renderHeaderCell:_26,"class":"dgrid-checkbox-header",label:""}];}_31.push(_34);}for(j=0;j<_32;j+=1){_31.push(_30(ths[j]));}}return _2e;};function _35(_36){var trs=_36.getElementsByTagName("tr"),_37=trs.length,tr,ctr=[],ths,_38,_39=[],i,j;for(i=0;i<_37;i+=1){tr=trs[i];ths=tr.getElementsByTagName("td");_38=ths.length;ctr=[];for(j=0;j<_38;j+=1){ctr.push(ths[j].firstElementChild);}if(ctr.length>1){ctr.unshift("");}_39.push(ctr);}return _39;};return _1("oreilly/types/dgrid/PagingGridCheckBox",[_c,_9],{"-chains-":{constructor:"manual"},dirty:{},field:null,selectAll:false,headerLevel:1,configStructure:function(){if(!this._checkedTrs){this._checkedTrs=true;if(this.showFooter){this.thead=this.srcNodeRef.getElementsByTagName("thead")[0];this.tfoot=(this.srcNodeRef.getElementsByTagName("tfoot").length>0)?this.srcNodeRef.getElementsByTagName("tfoot")[0]:null;this.subRows=_2a(this.thead,this.subRows,this);if(this.tfoot){this.customFooter=_35(this.tfoot);}}else{this.subRows=_2a(this.srcNodeRef,this.subRows,this);}}return this.inherited(arguments);},constructor:function(_3a){this.checked={};this.disabled={};_8.after(this,"renderArray",this.checkHeader);this.inherited(arguments);_c.prototype.constructor.apply(this,arguments);},postscript:function(){if(!this.domNode){this.inherited(arguments);}},checkHeader:function(){var _3b,_3c=this,_3d;_3b=_7.byId("oap-checkboxheader-"+_3c.id);_3b.set("checked",true);_3d=_3c.selectAll?(_3c.collection.storage.fullData||_3c.collection.objectStore.data):_3c._lastCollection;if(!_3d){_3c.refresh({keepCurrentPage:true});_3d=_3c.selectAll?(_3c.collection.storage.fullData||_3c.collection.objectStore.data):_3c._lastCollection;}_6.forEach(_3d,function(_3e){if(!_17(_3c,_3e)&&!_3c.disabled[_3e[_3c.collection.idProperty]]){_3b.set("checked",false);}});if(_3c.field!==null){_6.forEach(_3c.collection.storage.fullData||_3c.collection.objectStore.data,function(_3f){if(_17(_3c,_3f)&&!_3c.disabled[_3f[_3c.collection.idProperty]]){_3c.checked[_3f[_3c.collection.idProperty]]=_3f;}});}},getChecked:function(){var _40=this,_41=_40.collection.storage.index||_40.collection.objectStore.index,_42=_40.collection.storage.fullData||_40.collection.objectStore.data,_43=[];_6.forEach(Object.keys(_40.checked),function(_44){if(_41[_44]!==undefined&&_42[_41[_44]]!==undefined){_43.push(_40.checked[_44]);}else{delete _40.checked[_44];}});return _43;},on:function(_45,_46){if(_45==="checkbox"||_45==="checkbox-all"){return this.inherited(arguments);}return on(this.domNode,_45,_46);}});});