//>>built
define("oreilly/types/form/PhoneNumberBox",["dojo/_base/declare","dojo/_base/lang","dojo/ready","dojo/on","dojo/dom-class","dojo/string","dijit/form/ValidationTextBox"],function(_1,_2,_3,on,_4,_5,_6){return _1("PhoneNumberBox",[_6],{unformattedNumber:"",digits:10,numberFormat:"(###) ###-####",_formattedMaxLength:0,name:"phoneNumber",_inPostCreate:true,_fromSet:false,invalidMessageBase:"Please enter a :digit:-digit phone number",required:false,constructor:function(_7){var _8=this;_2.mixin(_8,_7);_8.digits=_8.numberFormat.split("#").length-1;},reset:function(){this.inherited(arguments);this.set("value",this._resetValue);},formatNumber:function(_9,_a){var _b=this,_c=_9||_b.get("displayedValue"),_d=_b.stripFormatting(_c),_e="",_f=0,_10=_d.length-1,i,_11=_a||_b.numberFormat;if(_10<=0||_d.length>_b.digits||_c===""){return _c;}for(i=0;i<_11.length;i++){if(_11[i]==="#"){_e+=_d[_f];_f++;if(_f>_10){break;}}else{_e+=_11[i];}}return _e;},stripFormatting:function(_12){_12=_12+"";return _12.replace(/\D/g,"");},set:function(_13,val){var _14=this;if(_13==="value"){_14._fromSet=true;}if(!_14._inPostCreate&&(_13==="maxlength"||_13==="maxLength")){return;}if(_13==="constraints"){return;}_14.inherited(arguments);},_setValueAttr:function(_15){var _16=this,val=_15;if(!_16._inPostCreate&&!_16._fromSet){val=_16.get("displayedValue");val=(val!==_15)?val:_15;}_16._fromSet=false;arguments[0]=_16.formatNumber(val);_16.inherited(arguments);},_getValueAttr:function(){var _17=this;_17.inherited(arguments);return _17.stripFormatting(_17.value);},_setNumberFormatAttr:function(nf){var _18=this;_18.numberFormat=_2.trim(nf);_18._formattedMaxLength=_18.numberFormat.length;_18.digits=_18.numberFormat.split("#").length-1;},_onFocus:function(){var _19=this,_1a=_5.rep("#",_19.digits+1),_1b=_19.numberFormat,_1c=(_19.get("state")==="Error");if(!_19.get("readOnly")){_19._inPostCreate=true;_19.set("maxlength",_19.digits);_19.set("numberFormat",_1a);_19.set("value",_19.unformattedNumber);_19.set("numberFormat",_1b);_19._inPostCreate=false;}_19.inherited(arguments);if(_1c){_19.set("state","Error");_19.set("message",_19.invalidMessage);}},_onBlur:function(){var _1d=this;_1d._inPostCreate=true;_1d.set("maxlength",_1d._formattedMaxLength);_1d._inPostCreate=false;_1d.inherited(arguments);},validator:function(){var _1e=true,_1f=this,_20=_1f.stripFormatting(_1f.get("displayedValue"));_1f.unformattedNumber=_20;_1f.promptMessage=_1f.invalidMessage=_1f.invalidMessageBase.replace(":digit:",_1f.digits);if(!_1f._inPostCreate&&_1f.required){_1e=_1e&&(_1f.get("displayedValue")!=="");}if(!_1f._inPostCreate&&_1f.get("displayedValue").length>0){_1e=_1e&&!isNaN(_20)&&(_20.length===_1f.digits);}if(!_1e&&!_1f._inPostCreate){_1f.set("state","Error");}return _1e;},postCreate:function(){var _21=this;_21.inherited(arguments);_21._formattedMaxLength=_21.numberFormat.length;_21.set("maxlength",_21.digits);_21._inPostCreate=false;}});});