//>>built
define("dgrid/Selector",["dojo/_base/declare","dojo/_base/lang","dojo/_base/sniff","./Selection","put-selector/put"],function(_1,_2,_3,_4,_5){return _1(_4,{postCreate:function(){this.inherited(arguments);this.on(".dgrid-selector:click,.dgrid-selector:keydown",_2.hitch(this,"_handleSelectorClick"));this.on("dgrid-select",_2.hitch(this,"_changeSelectorInput",true));this.on("dgrid-deselect",_2.hitch(this,"_changeSelectorInput",false));},_defaultRenderSelectorInput:function(_6,_7,_8,_9){var _a=_8.parentNode;var _b=_6.grid;_5(_a&&_a.contents?_a:_8,".dgrid-selector");var _c=_8.input||(_8.input=_5(_8,"input[type="+_6.selector+"]",{tabIndex:isNaN(_6.tabIndex)?-1:_6.tabIndex,disabled:!_b.allowSelect(_b.row(_9)),checked:_7}));_c.setAttribute("aria-checked",_7);return _c;},_configureSelectorColumn:function(_d){var _e=this;var _f=_d.selector;this._selectorColumns.push(_d);this._selectorSingleRow=this._selectorSingleRow||_d.selector==="radio";var _10=typeof _f==="function"?_f:this._defaultRenderSelectorInput;_d.sortable=false;_d.renderCell=function(_11,_12,_13){var row=_11&&_e.row(_11);_12=row&&_e.selection[row.id];_10(_d,!!_12,_13,_11);};_d.renderHeaderCell=function(th){var _14="label" in _d?_d.label:_d.field||"";if(_d.selector==="radio"||!_e.allowSelectAll){th.appendChild(document.createTextNode(_14));}else{_d._selectorHeaderCheckbox=_10(_d,false,th,{});_e._hasSelectorHeaderCheckbox=true;}};},_handleSelectorClick:function(_15){var _16=this.cell(_15);var row=_16.row;if(_15.type==="click"||_15.keyCode===32||(!_3("opera")&&_15.keyCode===13)||_15.keyCode===0){this._selectionTriggerEvent=_15;if(row){if(this.allowSelect(row)){var _17=this._lastSelected&&this.row(this._lastSelected);if(this._selectorSingleRow){if(!_17||_17.id!==row.id){this.clearSelection();this.select(row,null,true);this._lastSelected=row.element;}}else{if(row){if(_15.shiftKey){this._changeSelectorInput(true,{rows:[row]});}else{_17=null;}_17=_15.shiftKey?_17:null;this.select(_17||row,row,_17?undefined:null);this._lastSelected=row.element;}}}}else{this[this.allSelected?"clearSelection":"selectAll"]();}this._selectionTriggerEvent=null;}},_changeSelectorInput:function(_18,_19){if(this._selectorColumns.length){this._updateRowSelectors(_18,_19);}if(this._hasSelectorHeaderCheckbox){this._updateHeaderCheckboxes();}},_updateRowSelectors:function(_1a,_1b){var _1c=_1b.rows;var _1d=_1c.length;var _1e=this._selectorColumns.length;for(var _1f=0;_1f<_1d;_1f++){for(var _20=0;_20<_1e;_20++){var _21=this._selectorColumns[_20];var _22=this.cell(_1c[_1f],_21.id).element;if(!_22){continue;}_22=(_22.contents||_22).input;if(_22&&!_22.disabled){_22.checked=_1a;_22.setAttribute("aria-checked",_1a);}}}},_updateHeaderCheckboxes:function(){var _23=this._selectorColumns.length;for(var _24=0;_24<_23;_24++){var _25=this._selectorColumns[_24];var _26="false";var _27;var _28;var _29=_25._selectorHeaderCheckbox;if(_29){_27=this.selection;_28=false;for(var i in _27){if(_27[i]!=this.allSelected){_28=true;break;}}_29.indeterminate=_28;_29.checked=this.allSelected;if(_28){_26="mixed";}else{if(this.allSelected){_26="true";}}_29.setAttribute("aria-checked",_26);}}},configStructure:function(){this.inherited(arguments);var _2a=this.columns;this._selectorColumns=[];this._hasSelectorHeaderCheckbox=this._selectorSingleRow=false;for(var k in _2a){if(_2a[k].selector){this._configureSelectorColumn(_2a[k]);}}},_handleSelect:function(_2b){var _2c=this.cell(_2b).column;if(!_2c||!_2c.selector){this.inherited(arguments);}}});});