//>>built
define("dgrid/List",["dojo/_base/declare","dojo/on","dojo/has","./util/misc","xstyle/has-class","put-selector/put","dojo/_base/sniff","xstyle/css!./css/dgrid.css"],function(_1,_2,_3,_4,_5,_6){_5("mozilla","touch");_3.add("pointer",function(_7){return "PointerEvent" in _7?"pointer":"MSPointerEvent" in _7?"MSPointer":false;});var _8="dgrid-row-odd",_9="dgrid-row-even",_a,_b;function _c(id){return document.getElementById(id);};function _d(_e){_e.className="";if(_e.parentNode){document.body.removeChild(_e);}};function _f(_10,_11){_6(document.body,_10,".dgrid-scrollbar-measure");var _12=_10["offset"+_11]-_10["client"+_11];_d(_10);return _12;};_3.add("dom-scrollbar-width",function(_13,doc,_14){return _f(_14,"Width");});_3.add("dom-scrollbar-height",function(_15,doc,_16){return _f(_16,"Height");});_3.add("dom-rtl-scrollbar-left",function(_17,doc,_18){var div=_6("div"),_19;_6(document.body,_18,".dgrid-scrollbar-measure[dir=rtl]");_6(_18,div);_19=!!_3("ie")||!!_3("trident")||div.offsetLeft>=_3("dom-scrollbar-width");_d(_18);_6(div,"!");_18.removeAttribute("dir");return _19;});var _1a=0;function _1b(){return "dgrid_"+_1a++;};var _1c=/ +/g;function _1d(cls){var _1e=cls?"."+cls.replace(_1c,"."):"";if(this._class){_1e="!"+this._class.replace(_1c,"!")+_1e;}_6(this.domNode,_1e);this._class=cls;};function _1f(){return this._class;};var _20=function(){if(this._started){this.resize();}};return _1(null,{tabableHeader:false,showHeader:false,showFooter:false,maintainOddEven:true,cleanAddedRules:true,addUiClasses:true,highlightDuration:250,postscript:function(_21,_22){var _23=this;(this._Row=function(id,_24,_25){this.id=id;this.data=_24;this.element=_25;}).prototype.remove=function(){_23.removeRow(this.element);};if(_22){this.srcNodeRef=_22=_22.nodeType?_22:_c(_22);}this.create(_21,_22);},listType:"list",create:function(_26,_27){var _28=this.domNode=_27||_6("div"),cls;if(_26){this.params=_26;_1.safeMixin(this,_26);cls=_26["class"]||_26.className||_28.className;}this.sort=this.sort||[];this._listeners=[];this._rowIdToObject={};this.postMixInProperties&&this.postMixInProperties();this.id=_28.id=_28.id||this.id||_1b();this.buildRendering();if(cls){_1d.call(this,cls);}this.postCreate();delete this.srcNodeRef;if(this.domNode.offsetHeight){this.startup();}},buildRendering:function(){var _29=this.domNode,_2a=this.addUiClasses,_2b=this,_2c,_2d,_2e,_2f;_2f=this.isRTL=(document.body.dir||document.documentElement.dir||document.body.style.direction).toLowerCase()==="rtl";_29.className="";_6(_29,"[role=grid].dgrid.dgrid-"+this.listType+(_2a?".ui-widget":""));_2c=this.headerNode=_6(_29,"div.dgrid-header.dgrid-header-row"+(_2a?".ui-widget-header":"")+(this.showHeader?"":".dgrid-header-hidden"));_2d=this.bodyNode=_6(_29,"div.dgrid-scroller");if(_3("ff")){_2d.tabIndex=-1;}this.headerScrollNode=_6(_29,"div.dgrid-header.dgrid-header-scroll.dgrid-scrollbar-width"+(_2a?".ui-widget-header":""));_2e=this.footerNode=_6("div.dgrid-footer"+(this.showFooter?"":".dgrid-footer-hidden"));_6(_29,_2e);if(_2f){_29.className+=" dgrid-rtl"+(_3("dom-rtl-scrollbar-left")?" dgrid-rtl-swap":"");}_2(_2d,"scroll",function(_30){if(_2b.showHeader){_2c.scrollLeft=_30.scrollLeft||_2d.scrollLeft;}_30.stopPropagation();_2.emit(_29,"scroll",{scrollTarget:_2d});});this.configStructure();this.renderHeader();this.contentNode=this.touchNode=_6(this.bodyNode,"div.dgrid-content"+(_2a?".ui-widget-content":""));this._listeners.push(this._resizeHandle=_2(window,"resize",_4.throttleDelayed(_20,this)));},postCreate:function(){},startup:function(){if(this._started){return;}this.inherited(arguments);this._started=true;this.resize();this.set("sort",this.sort);},configStructure:function(){},resize:function(){var _31=this.bodyNode,_32=this.headerNode,_33=this.footerNode,_34=_32.offsetHeight,_35=this.showFooter?_33.offsetHeight:0;this.headerScrollNode.style.height=_31.style.marginTop=_34+"px";_31.style.marginBottom=_35+"px";if(!_a){_a=_3("dom-scrollbar-width");_b=_3("dom-scrollbar-height");if(_3("ie")){_a++;_b++;}_4.addCssRule(".dgrid-scrollbar-width","width: "+_a+"px");_4.addCssRule(".dgrid-scrollbar-height","height: "+_b+"px");if(_a!==17){_4.addCssRule(".dgrid-header-row","right: "+_a+"px");_4.addCssRule(".dgrid-rtl-swap .dgrid-header-row","left: "+_a+"px");}}},addCssRule:function(_36,css){var _37=_4.addCssRule(_36,css);if(this.cleanAddedRules){this._listeners.push(_37);}return _37;},on:function(_38,_39){var _3a=_2(this.domNode,_38,_39);if(!_3("dom-addeventlistener")){this._listeners.push(_3a);}return _3a;},cleanup:function(){var i;for(i in this._rowIdToObject){if(this._rowIdToObject[i]!==this.columns){var _3b=_c(i);if(_3b){this.removeRow(_3b,true);}}}},destroy:function(){if(this._listeners){for(var i=this._listeners.length;i--;){this._listeners[i].remove();}this._listeners=null;}this._started=false;this.cleanup();_6(this.domNode,"!");},refresh:function(){this.cleanup();this._rowIdToObject={};this._autoId=0;this.contentNode.innerHTML="";this.scrollTo({x:0,y:0});},highlightRow:function(_3c,_3d){_3c=_3c.element||_3c;_6(_3c,".dgrid-highlight"+(this.addUiClasses?".ui-state-highlight":""));setTimeout(function(){_6(_3c,"!dgrid-highlight!ui-state-highlight");},_3d||this.highlightDuration);},adjustRowIndices:function(_3e){var _3f=_3e;var _40=_3f.rowIndex;if(_40>-1){do{if(_3f.rowIndex>-1){if(this.maintainOddEven){if((_3f.className+" ").indexOf("dgrid-row ")>-1){_6(_3f,"."+(_40%2===1?_8:_9)+"!"+(_40%2===0?_8:_9));}}_3f.rowIndex=_40++;}}while((_3f=_3f.nextSibling)&&_3f.rowIndex!==_40);}},renderArray:function(_41,_42,_43){_43=_43||{};var _44=this,_45=_43.start||0,_46=document.createDocumentFragment(),_47=[],_48,i=0,len=_41.length;if(!_42){this._lastCollection=_41;}while(i<len){_47[i]=this.insertRow(_41[i],_46,null,_45++,_43);i++;}_48=_42?_42.parentNode:_44.contentNode;if(_48&&_48.parentNode&&(_48!==_44.contentNode||len)){_48.insertBefore(_46,_42||null);if(len){_44.adjustRowIndices(_47[len-1]);}}return _47;},renderHeader:function(){},_autoId:0,insertRow:function(_49,_4a,_4b,i,_4c){var id=this.id+"-row-"+((this.collection&&this.collection.getIdentity)?this.collection.getIdentity(_49):this._autoId++),row=_c(id),_4d=row&&row.previousSibling;if(row){if(row===_4b){_4b=(_4b.connected||_4b).nextSibling;}this.removeRow(row);}row=this.renderRow(_49,_4c);row.className=(row.className||"")+" dgrid-row "+(i%2===1?_8:_9)+(this.addUiClasses?" ui-state-default":"");this._rowIdToObject[row.id=id]=_49;_4a.insertBefore(row,_4b||null);row.rowIndex=i;if(_4d&&_4d.rowIndex!==(row.rowIndex-1)){this.adjustRowIndices(_4d);}return row;},renderRow:function(_4e){return _6("div",""+_4e);},removeRow:function(_4f,_50){_4f=_4f.element||_4f;delete this._rowIdToObject[_4f.id];if(!_50){_6(_4f,"!");}},row:function(_51){var id;if(_51 instanceof this._Row){return _51;}if(_51.target&&_51.target.nodeType){_51=_51.target;}if(_51.nodeType){var _52;do{var _53=_51.id;if((_52=this._rowIdToObject[_53])){return new this._Row(_53.substring(this.id.length+5),_52,_51);}_51=_51.parentNode;}while(_51&&_51!==this.domNode);return;}if(typeof _51==="object"){id=this.collection.getIdentity(_51);}else{id=_51;_51=this._rowIdToObject[this.id+"-row-"+id];}return new this._Row(id,_51,_c(this.id+"-row-"+id));},cell:function(_54){return {row:this.row(_54)};},_move:function(_55,_56,_57,_58){var _59,_5a,_5b;_5b=_5a=_55.element;_56=_56||1;do{if((_59=_5a[_56<0?"previousSibling":"nextSibling"])){do{_5a=_59;if(_5a&&(_5a.className+" ").indexOf(_57+" ")>-1){_5b=_5a;_56+=_56<0?1:-1;break;}}while((_59=(!_58||!_5a.hidden)&&_5a[_56<0?"lastChild":"firstChild"]));}else{_5a=_5a.parentNode;if(!_5a||_5a===this.bodyNode||_5a===this.headerNode){break;}}}while(_56);return _5b;},up:function(row,_5c,_5d){if(!row.element){row=this.row(row);}return this.row(this._move(row,-(_5c||1),"dgrid-row",_5d));},down:function(row,_5e,_5f){if(!row.element){row=this.row(row);}return this.row(this._move(row,_5e||1,"dgrid-row",_5f));},scrollTo:function(_60){if(typeof _60.x!=="undefined"){this.bodyNode.scrollLeft=_60.x;}if(typeof _60.y!=="undefined"){this.bodyNode.scrollTop=_60.y;}},getScrollPosition:function(){return {x:this.bodyNode.scrollLeft,y:this.bodyNode.scrollTop};},get:function(_61){var fn="_get"+_61.charAt(0).toUpperCase()+_61.slice(1);if(typeof this[fn]==="function"){return this[fn].apply(this,[].slice.call(arguments,1));}if(!1&&typeof this[fn+"Attr"]==="function"){console.warn("dgrid: Use "+fn+" instead of "+fn+"Attr for getting "+_61);}return this[_61];},set:function(_62,_63){if(typeof _62==="object"){for(var k in _62){this.set(k,_62[k]);}}else{var fn="_set"+_62.charAt(0).toUpperCase()+_62.slice(1);if(typeof this[fn]==="function"){this[fn].apply(this,[].slice.call(arguments,1));}else{if(!1&&typeof this[fn+"Attr"]==="function"){console.warn("dgrid: Use "+fn+" instead of "+fn+"Attr for setting "+_62);}this[_62]=_63;}}return this;},_getClass:_1f,_setClass:_1d,_getClassName:_1f,_setClassName:_1d,_setSort:function(_64,_65){this.sort=typeof _64!=="string"?_64:[{property:_64,descending:_65}];this._applySort();},_applySort:function(){this.refresh();if(this._lastCollection){var _66=this.sort;if(_66&&_66.length>0){var _67=_66[0].property,_68=!!_66[0].descending;this._lastCollection.sort(function(a,b){var _69=a[_67],_6a=b[_67];if(_69===undefined){_69="";}if(_6a===undefined){_6a="";}return _69===_6a?0:(_69>_6a!==_68?1:-1);});}this.renderArray(this._lastCollection);}},_setShowHeader:function(_6b){var _6c=this.headerNode;this.showHeader=_6b;_6(_6c,(_6b?"!":".")+"dgrid-header-hidden");this.renderHeader();this.resize();if(_6b){_6c.scrollLeft=this.getScrollPosition().x;}},_setShowFooter:function(_6d){this.showFooter=_6d;_6(this.footerNode,(_6d?"!":".")+"dgrid-footer-hidden");this.resize();}});});