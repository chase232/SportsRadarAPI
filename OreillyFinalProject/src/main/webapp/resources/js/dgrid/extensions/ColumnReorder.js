//>>built
define("dgrid/extensions/ColumnReorder",["dojo/_base/lang","dojo/_base/declare","dojo/_base/array","dojo/on","dojo/query","dojo/dnd/Source","put-selector/put","xstyle/css!../css/extensions/ColumnReorder.css"],function(_1,_2,_3,on,_4,_5,_6){var _7=/(\d+)(?:-(\d+))?$/;function _8(_9,_a){var _b=_a[2],_c=_9[_b?"columnSets":"subRows"][_a[1]];return _b?_c[_a[2]]:_c;};function _d(_e,_f,_10){if(_f[2]){_e.columnSets[_f[1]][_f[2]]=_10;}else{_e.subRows[_f[1]]=_10;}};function _11(_12){return "dgrid-"+_12+"-";};function _13(_14,_15){return _15.slice(_11(_14).length);};var _16=_2(_5,{copyState:function(){return false;},checkAcceptance:function(_17){return _17===this;},_legalMouseDown:function(evt){return evt.target.className.indexOf("dgrid-resize-handle")>-1?false:this.inherited(arguments);},onDropInternal:function(_18){var _19=this.grid,_1a=_7.exec(_13(_19.id,_18[0].getAttribute("dndType"))),_1b=_1a[2]?"columnSets":"subRows",_1c=_8(_19,_1a),_1d=_19.columns;this.inherited(arguments);if(!_1a){return;}setTimeout(function(){var _1e=_3.map(_18[0].parentNode.childNodes,function(col){return _1d[col.columnId];}),_1f;_d(_19,_1a,_1e);_1f={grid:_19,subRow:_1e,column:_1d[_18[0].columnId],bubbles:true,cancelable:true,parentType:"dnd"};_1f[_1b]=_19[_1b];if(on.emit(_19.domNode,"dgrid-columnreorder",_1f)){_19.set(_1b,_19[_1b]);}else{_d(_19,_1a,_1c);_19.renderHeader();if(_19.sort.length){_19.updateSortArrow(_19.sort);}}},0);}});var _20=_2(null,{columnDndConstructor:_16,_initSubRowDnd:function(_21,_22){var _23,c,len,col,th;for(c=0,len=_21.length;c<len;c++){col=_21[c];if(col.reorderable===false){continue;}th=col.headerNode;_6(th,".dojoDndItem[dndType="+_22+"]");if(!_23){_23=th.parentNode;}}if(_23){this._columnDndSources.push(new this.columnDndConstructor(_23,{horizontal:true,grid:this}));}},renderHeader:function(){var _24=_11(this.id),_25,cs;this.inherited(arguments);this._columnDndSources=[];if(this.columnSets){for(cs=0,_25=this.columnSets.length;cs<_25;cs++){_3.forEach(this.columnSets[cs],function(_26,sr){this._initSubRowDnd(_26,_24+cs+"-"+sr);},this);}}else{_3.forEach(this.subRows,function(_27,sr){this._initSubRowDnd(_27,_24+sr);},this);}},_destroyColumns:function(){if(this._columnDndSources){_3.forEach(this._columnDndSources,function(_28){_28.destroy();});}this.inherited(arguments);}});_20.ColumnDndSource=_16;return _20;});