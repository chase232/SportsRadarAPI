//>>built
define("dgrid/ColumnSet",["dojo/_base/declare","dojo/_base/lang","dojo/on","dojo/aspect","dojo/query","dojo/has","./util/misc","put-selector/put","dojo/_base/sniff","xstyle/css!./css/columnset.css"],function(_1,_2,on,_3,_4,_5,_6,_7){_5.add("event-mousewheel",function(_8,_9,_a){return typeof _a.onmousewheel!=="undefined";});_5.add("event-wheel",function(_b){var _c=false;try{_b.WheelEvent("wheel");_c=true;}catch(e){}return _c;});var _d="data-dgrid-column-set-id";function _e(_f,row){var _10=_f._columnSetScrollLefts;_4(".dgrid-column-set",row).forEach(function(_11){_11.scrollLeft=_10[_11.getAttribute(_d)];});};function _12(_13,_14,_15){var id=_14.getAttribute(_d);var _16=_13._columnSetScrollers[id];_16.scrollLeft=_15<0?0:_15;};function _17(_18,_19){if(!_18||!_18.length){return;}var _1a=[];var _1b=_19+"-";for(var i=0,_1c=_18.length;i<_1c;i++){var row=_18[i];var _1d=[];_1d.className=row.className;for(var k=0,_1e=row.length;k<_1e;k++){var _1f=row[k];if(_1f.id!=null&&_1f.id.indexOf(_1b)===0){_1d.push(_1f);}}_1a.push(_1d);}return _1a;};function _20(_21,_22){if(_21.nodeType!==1){_21=_21.parentNode;}while(_21&&!_4.matches(_21,".dgrid-column-set["+_d+"]",_22)){_21=_21.parentNode;}return _21;};var _23={start:"down",end:"up"};function _24(_25){var _26=_5("pointer");if(_26){_25=_23[_25]||_25;if(_26.slice(0,2)==="MS"){return "MSPointer"+_25.slice(0,1).toUpperCase()+_25.slice(1);}else{return "pointer"+_25;}}return "touch"+_25;};var _27=_5("touch")&&function(_28){return function(_29,_2a){var _2b=[on(_29,_24("start"),function(_2c){if(!_28._currentlyTouchedColumnSet){var _2d=_20(_2c.target,_29);if(_2d&&(!_2c.pointerType||_2c.pointerType==="touch"||_2c.pointerType===2)){_28._currentlyTouchedColumnSet=_2d;_28._lastColumnSetTouchX=_2c.clientX;_28._lastColumnSetTouchY=_2c.clientY;}}}),on(_29,_24("move"),function(_2e){if(_28._currentlyTouchedColumnSet===null){return;}var _2f=_20(_2e.target);if(!_2f){return;}_2a.call(null,_28,_2f,_28._lastColumnSetTouchX-_2e.clientX);_28._lastColumnSetTouchX=_2e.clientX;_28._lastColumnSetTouchY=_2e.clientY;}),on(_29,_24("end"),function(){_28._currentlyTouchedColumnSet=null;})];return {remove:function(){for(var i=_2b.length;i--;){_2b[i].remove();}}};};};var _30=_5("event-mousewheel")||_5("event-wheel")?function(_31){return function(_32,_33){return on(_32,_5("event-wheel")?"wheel":"mousewheel",function(_34){var _35=_20(_34.target,_32),_36;if(!_35){return;}_36=_34.deltaX||-_34.wheelDeltaX/3;if(_36){_33.call(null,_31,_35,_36);}});};}:function(_37){return function(_38,_39){return on(_38,".dgrid-column-set["+_d+"]:MozMousePixelScroll",function(_3a){if(_3a.axis===1){_39.call(null,_37,this,_3a.detail);}});};};function _3b(_3c,_3d,_3e){var id=_3d.getAttribute(_d),_3f=_3c._columnSetScrollers[id],_40=_3f.scrollLeft+_3e;_3f.scrollLeft=_40<0?0:_40;};return _1(null,{postCreate:function(){var _41=this;this.inherited(arguments);this.on(_30(this),_3b);if(_5("touch")){this.on(_27(this),_3b);}this.on(".dgrid-column-set:dgrid-cellfocusin",function(_42){_41._onColumnSetCellFocus(_42,this);});},columnSets:[],createRowCells:function(tag,_43,_44,_45){var row=_7("table.dgrid-row-table");var tr=_7(row,"tbody tr");for(var i=0,l=this.columnSets.length;i<l;i++){var _46=_7(tr,tag+".dgrid-column-set-cell.dgrid-column-set-"+i+" div.dgrid-column-set["+_d+"="+i+"]");var _47=_17(_44||this.subRows,i)||this.columnSets[i];_46.appendChild(this.inherited(arguments,[tag,_43,_47,_45]));}return row;},renderArray:function(){var _48=this.inherited(arguments);for(var i=0;i<_48.length;i++){_e(this,_48[i]);}return _48;},renderHeader:function(){this.inherited(arguments);var _49=this.columnSets,_4a=this._columnSetScrollers,_4b=this,i,l;function _4c(){_4b._positionScrollers();};this._columnSetScrollerContents={};this._columnSetScrollLefts={};if(_4a){for(i in _4a){_7(_4a[i],"!");}}else{_3.after(this,"resize",_4c,true);_3.after(this,"styleColumn",_4c,true);this._columnSetScrollerNode=_7(this.footerNode,"+div.dgrid-column-set-scroller-container");}_4a=this._columnSetScrollers={};for(i=0,l=_49.length;i<l;i++){this._putScroller(_49[i],i);}this._positionScrollers();},styleColumnSet:function(_4d,css){var _4e=this.addCssRule("#"+_6.escapeCssIdentifier(this.domNode.id)+" .dgrid-column-set-"+_6.escapeCssIdentifier(_4d,"-"),css);this._positionScrollers();return _4e;},_destroyColumns:function(){var _4f=this.columnSets.length,i,j,k,_50,len,_51,_52,_53;for(i=0;i<_4f;i++){_51=this.columnSets[i];for(j=0,_50=_51.length;j<_50;j++){_52=_51[j];for(k=0,len=_52.length;k<len;k++){_53=_52[k];if(typeof _53.destroy==="function"){_53.destroy();}}}}this.inherited(arguments);},configStructure:function(){this.columns={};this.subRows=[];for(var i=0,l=this.columnSets.length;i<l;i++){var _54=this.columnSets[i];for(var j=0;j<_54.length;j++){_54[j]=this._configColumns(i+"-"+j+"-",_54[j]);}}this.inherited(arguments);},_positionScrollers:function(){var _55=this.domNode,_56=this._columnSetScrollers,_57=this._columnSetScrollerContents,_58=this.columnSets,_59=0,_5a=0,i,l,_5b,_5c;for(i=0,l=_58.length;i<l;i++){_5b=_4(".dgrid-column-set["+_d+"=\""+i+"\"]",_55)[0];_59=_5b.offsetWidth;_5c=_5b.firstChild.offsetWidth;_57[i].style.width=_5c+"px";_56[i].style.width=_59+"px";if(_5("ie")<9){_56[i].style.overflowX=_5c>_59?"scroll":"auto";}if(_5c>_59){_5a++;}}this._columnSetScrollerNode.style.bottom=this.showFooter?this.footerNode.offsetHeight+"px":"0";this.bodyNode.style.bottom=_5a?(_5("dom-scrollbar-height")+(_5("ie")?1:0)+"px"):"0";},_putScroller:function(_5d,i){var _5e=this._columnSetScrollers[i]=_7(this._columnSetScrollerNode,"span.dgrid-column-set-scroller.dgrid-column-set-scroller-"+i+"["+_d+"="+i+"]");this._columnSetScrollerContents[i]=_7(_5e,"div.dgrid-column-set-scroller-content");on(_5e,"scroll",_2.hitch(this,"_onColumnSetScroll"));},_onColumnSetScroll:function(evt){var _5f=evt.target.scrollLeft,_60=evt.target.getAttribute(_d),_61;if(this._columnSetScrollLefts[_60]!==_5f){_4(".dgrid-column-set["+_d+"=\""+_60+"\"], .dgrid-column-set-scroller["+_d+"=\""+_60+"\"]",this.domNode).forEach(function(_62,i){_62.scrollLeft=_5f;if(!i){_61=_62.scrollLeft;}});this._columnSetScrollLefts[_60]=_61;}},_setColumnSets:function(_63){this._destroyColumns();this.columnSets=_63;this._updateColumns();},_onColumnSetCellFocus:function(_64,_65){var _66=_64.target;var _67=_65.getAttribute(_d);var _68=this._columnSetScrollers[_67];var _69=_66.offsetLeft-_68.scrollLeft+_66.offsetWidth;if(_69>_65.offsetWidth||_68.scrollLeft>_66.offsetLeft){_12(this,_65,_66.offsetLeft);}}});});