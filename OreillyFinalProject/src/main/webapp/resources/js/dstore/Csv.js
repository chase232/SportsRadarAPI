//>>built
define("dstore/Csv",["dojo/_base/lang","dojo/_base/declare"],function(_1,_2){var _3=/^\s*"([\S\s]*)"\s*$/,_4=/""/g,_5=/"/g;function _6(_7,_8){var _9={},_a=_7.length,i;for(i=0;i<_a;i++){_9[_7[i]]=_8[i];}return _9;};return _2(null,{fieldNames:null,delimiter:",",newline:"\r\n",trim:false,parse:function(_b){var _c=[],_d=_b.split(this.newline),_e=this.fieldNames,_f=0,_10=[],_11="",_12="",_13,_14,_15,_16,_17,i,j,k;lineloop:for(i=0,_15=_d.length;i<_15;i++){if(!_1.trim(_d[i])){continue;}_13=_d[i].split(this.delimiter);for(j=0,_16=_13.length;j<_16;j++){_14=_13[j];k=-1;_11+=_12+_14;_12="";while((k=_14.indexOf("\"",k+1))>=0){_f++;}if(_f%2===0){if(_f>0){_17=_3.exec(_11);if(_17){_10.push(_17[1].replace(_4,"\""));}else{console.warn("Csv: discarding row with invalid value: "+_11);_10=[];_11="";_f=0;continue lineloop;}}else{_10.push(this.trim||!_e?_1.trim(_11):_11);}_11="";_f=0;}else{_12=this.delimiter;}}if(_f===0){if(!_e){_e=this.fieldNames=_10;}else{_c.push(_6(_e,_10));}_10=[];}else{_12=this.newline;}}return _c;},toCsv:function(_18){return this.stringify(this.data,_18);},stringify:function(_19,_1a){_1a=_1a||{};var _1b=_1a.alwaysQuote,_1c=this.fieldNames,_1d=this.delimiter,_1e=this.newline,_1f="",i,j,_20,_21;for(i=-1;i<_19.length;i++){if(i>-1){_1f+=_1e;}for(j=0;j<_1c.length;j++){_20=i<0?_1c[j]:_19[i][_1c[j]];_21=_1b||_20.indexOf("\"")>=0||_20.indexOf(_1d)>=0;_1f+=(j>0?_1d:"")+(_21?"\""+_20.replace(_5,"\"\"")+"\"":_20);}}if(_1a.trailingNewline){_1f+=_1e;}return _1f;}});});