//>>built
define("dstore/Rest",["dojo/request","dojo/when","dojo/_base/lang","dojo/json","dojo/io-query","dojo/_base/declare","./Request"],function(_1,_2,_3,_4,_5,_6,_7){return _6(_7,{stringify:_4.stringify,get:function(id,_8){_8=_8||{};var _9=_3.mixin({Accept:this.accepts},this.headers,_8.headers||_8);var _a=this;return _1(this.target+id,{headers:_9}).then(function(_b){return _a._restore(_a.parse(_b),true);});},autoEmitEvents:false,put:function(_c,_d){_d=_d||{};var id=("id" in _d)?_d.id:this.getIdentity(_c);var _e=typeof id!=="undefined";var _f=this;var _10="beforeId" in _d?(_d.beforeId===null?{"Put-Default-Position":"end"}:{"Put-Before":_d.beforeId}):(!_e||_d.overwrite===false?{"Put-Default-Position":(this.defaultNewToStart?"start":"end")}:null);var _11=_1(_e?this.target+id:this.target,{method:_e&&!_d.incremental?"PUT":"POST",data:this.stringify(_c),headers:_3.mixin({"Content-Type":"application/json",Accept:this.accepts,"If-Match":_d.overwrite===true?"*":null,"If-None-Match":_d.overwrite===false?"*":null},_10,this.headers,_d.headers)});return _11.then(function(_12){var _13={};if("beforeId" in _d){_13.beforeId=_d.beforeId;}var _14=_13.target=_f._restore(_f.parse(_12),true)||_c;_2(_11.response,function(_15){_f.emit(_15.status===201?"add":"update",_13);});return _14;});},add:function(_16,_17){_17=_17||{};_17.overwrite=false;return this.put(_16,_17);},remove:function(id,_18){_18=_18||{};var _19=this;return _1(this.target+id,{method:"DELETE",headers:_3.mixin({},this.headers,_18.headers)}).then(function(_1a){var _1b=_1a&&_19.parse(_1a);_19.emit("delete",{id:id,target:_1b});return _1a?_1b:true;});}});});